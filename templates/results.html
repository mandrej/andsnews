{% extends "base.html" %}

{% block subnav %}{% endblock %}
{% block aside %}{% endblock %}
{% block modals %}{% endblock %}

{% block contents %}
<script src="/static/scripts/jquery.highlight.js"></script>
<script>
$(function() {
	var options = {exact: "partial", highlight: "#main", keys: '{{ phrase }}'};
	$(document).SearchHighlight(options);
});
</script>
<article class="plain">
	{% if phrase %}
		<h2>{% trans count=number_found %}{{ count }} search result for {{ phrase }}{% pluralize %}{{ count }} search results for {{ phrase }}{% endtrans %}
            {% if page != 1 %} [{{ page }}]{% endif %}
        </h2>
	{% else %}
		<h2>{{ _('Nothing to search for') }}.</h2>
        <p>{{ _('Please try something') }}.</p>
	{% endif %}

    {% macro result(object) %}
        <div class="third brick">
            <div class="icon {{ object.kind }}">
                <h3>
                    {% if object.link %}
                        {% if object.kind == 'Comment' %}
                            <a href="{{ object.link }}?find={{ phrase }}#comments">
                                {{ object.headline }} ({{ _('comment') }})</a>
                        {% else %}
                            <a href="{{ object.link }}?find={{ phrase }}">
                                {{ object.headline }}</a>
                        {% endif %}
                    {% else %}
                        {{ _('message') }}
                    {% endif %}
                    {% if object.tags %}
                        <br>{{ _('tagged by') }}: {{ object.tags }}
                    {% endif %}
                </h3>
                {{ object.body }}
                <p class="details">
                    <strong>{{ object.author }}</strong>,
                    <time datetime='{{ object.date|format_datetime }}'>
                        {{ object.date|format_date }}</time></p>
            </div>
        </div>
    {% endmacro %}
    <div id="container">
        {% for object in objects %}
            {{ result(object) }}
        {% else %}
            <section class="third brick">
                <div class="white none">
                    <h3>{{ _('No search results for') }} {{ phrase }}.</h3>
                    <p>{{ _('Please try again') }}.</p>
                    {% if error %}
                        <p>{{ _('Error') }}: {{ error }}</p>
                    {% endif %}
                </div>
            </section>
        {% endfor %}
    </div>
</article>
{% endblock %}
