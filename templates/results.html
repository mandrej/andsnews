{% extends "base.html" %}
{% import "snippets/macros.html" as m %}

{% block modals %}{% endblock %}

{% block contents %}
<aside>
    <nav class="submenu">
        <h2><a href="{{ uri_for('start') }}">{{ _('Start ') }}</a></h2>
    </nav>
</aside>
<article>
	{% if phrase %}
		<h2>{% trans count=number_found %}{{ count }} search result for {{ phrase }}{% pluralize %}{{ count }} search results for {{ phrase }}{% endtrans %}
            {{ m.page_number(page) }}
        </h2>
	{% else %}
		<h2>{{ _('Nothing to search for') }}.</h2>
        <p>{{ _('Please try something') }}.</p>
	{% endif %}

    {% macro result(object) %}
        <div class="third brick">
            <div>
                {% if object.kind == 'Photo' %}
                    <i class="icon-picture icon-3x pull-left"></i>
                    <h3><a href="{{ object.link }}?find={{ phrase }}">
                        {{ object.headline }}</a>
                        {% for tag in object.tags|split %}
                            {% if loop.first %}<br><i class="icon-tag"></i>{% endif %}
                            <a href="{{ uri_for('photo_filter_all', field='tags', value=tag) }}">
                                {{ tag }}</a>{% if not loop.last %},{% endif %}
                        {% endfor %}
                    </h3>
                {% elif object.kind == 'Entry' %}
                    <i class="icon-file icon-3x pull-left"></i>
                    <h3><a href="{{ object.link }}?find={{ phrase }}">
                        {{ object.headline }}</a>
                        {% for tag in object.tags|split %}
                            {% if loop.first %}<br><i class="icon-tag"></i>{% endif %}
                            <a href="{{ uri_for('entry_filter_all', field='tags', value=tag) }}">
                                {{ tag }}</a>{% if not loop.last %},{% endif %}
                        {% endfor %}
                    </h3>
                {% elif object.kind == 'Comment' %}
                    {% if object.headline %}
                        <i class="icon-comment-alt icon-3x pull-left"></i>
                        <h3><a href="{{ object.link }}?find={{ phrase }}">
                            {{ object.headline }} ({{ _('comment') }})</a></h3>
                    {% else %}
                        <i class="icon-comment icon-3x pull-left"></i>
                        <h3>{{ _('message') }}</h3>
                    {% endif %}
                {% endif %}
                {{ object.body }}
                <p class="details">
                    <strong>{{ object.author }}</strong>,
                    <time datetime='{{ object.date|to_datetime }}'>
                        {{ object.date|to_date }}</time></p>
            </div>
        </div>
    {% endmacro %}

    <div id="container">
        {% for object in objects %}
            {{ result(object) }}
        {% else %}
            <section class="third">
                <div class="box">
                    <h3>{{ _('No search results for') }} {{ phrase }}.</h3>
                    <p>{{ _('Please try again') }}.</p>
                    {% if error %}
                        <p>{{ _('Error') }}: {{ error }}</p>
                    {% endif %}
                </div>
            </section>
        {% endfor %}
    </div>
</article>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>deferred_load();</script>
{% endblock %}