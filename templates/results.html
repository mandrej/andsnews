{% extends "index.html" %}

{% block subnav %}{% endblock %}
{% block aside %}{% endblock %}
{% block modals %}{% endblock %}

{% block contents %}
<script src="/static/scripts/jquery.highlight.js"></script>
<script>
$(function() {
	var options = {exact: "partial", highlight: "#main", keys: '{{ phrase }}'};
	$(document).SearchHighlight(options);
});
</script>
<article class="plain">
	{% if phrase %}
		{% if objects %}
			<h2>{% trans count=number_found %}{{ count }} search result for {{ phrase }}{% pluralize %}{{ count }} search results for {{ phrase }}{% endtrans %}{% if page != 1 %} [{{ page }}]{% endif %}</h2>
		{% else %}
			<h2>{{ _('No results') }}</h2>
			{% popup noresults %}
				<p>{{ _('No search results for') }} {{ phrase }}.
					{{ _('Please try again') }}.</p>
			{% endpopup %}
		{% endif %}
	{% else %}
		<h2>{{ _('No results') }}</h2>
			{% popup noresults %}
				<p>{{ _('Nothing to search for') }}.
					{{ _('Please try something') }}.</p>
			{% endpopup %}
	{% endif %}
	
	{% for object in objects %}
		{% if object.kind == 'Application' %}
	        <div class="icon Message">
                <h3>{{ _('message') }}
	                {% if object.tags %}
	                	<br>{{ _('tagged by') }}: {{ object.tags }}
	                {% endif %}
                </h3>
                {{ object.body|snippet:phrase }}
                <p class="details"><strong>{{ object.author }}</strong>,
                    <time datetime='{{ object.date|date:"Y-m-d\TH:i:sO" }}'>
                        {{ object.date|date:"Y-m-d" }}</time></p>
            </div>
		{% endif %}
		{% if object.kind == 'Comment' %}
	        <div class="icon Comment">
                <h3><a href="{{ object.link }}?find={{ phrase|urlencode }}#comments">
                	{{ object.headline }} ({{ _('comment') }})</a>
                	{% if object.tags %}
	                	<br>{{ _('tagged by') }}: {{ object.tags }}
	                {% endif %}
                </h3>
                {{ object.body|snippet:phrase }}
                <p class="details"><strong>{{ object.author }}</strong>,
                    <time datetime='{{ object.date|date:"Y-m-d\TH:i:sO" }}'>
                        {{ object.date|date:"Y-m-d" }}</time></p>
            </div>
		{% endif %}
		{% if object.kind == 'Entry' %}
	        <div class="icon Entry">
	            <h3><a href="{{ object.link }}?find={{ phrase|urlencode }}">
	            	{{ object.headline }}</a>
	            	{% if object.tags %}
	                	<br>{{ _('tagged by') }}: {{ object.tags }}
	                {% endif %}
	            </h3>
	            {{ object.body|snippet:phrase }}
	            <p class="details"><strong>{{ object.author }}</strong>,
	                <time datetime='{{ object.date|date:"Y-m-d\TH:i:sO" }}'>
	                    {{ object.date|date:"Y-m-d" }}</time></p>
	        </div>
		{% endif %}
		{% if object.kind == 'Photo' %}
	        <div class="icon Photo">
	            <h3><a href="{{ object.link }}?find={{ phrase|urlencode }}">
	            	{{ object.headline }}</a>
	            	{% if object.tags %}
	                	<br>{{ _('tagged by') }}: {{ object.tags }}
	                {% endif %}
	            </h3>
	            {{ object.body|snippet:phrase }}
	            <p class="details"><strong>{{ object.author }}</strong>,
	                <time datetime='{{ object.date|date:"Y-m-d\TH:i:sO" }}'>
	                    {{ object.date|date:"Y-m-d" }}</time></p>
	        </div>
		{% endif %}
	{% endfor %}
</article>
{% endblock %}
