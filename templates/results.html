{% extends "base.html" %}
{% block modals %}{% endblock %}

{% block contents %}
<div class="page">
    {% import "snippets/macros.html" as m %}
    <header>
        {% if phrase %}
            <h2>{% trans count=number_found %}{{ count }} search result for '{{ phrase }}'{% pluralize %}{{ count }} search results for '{{ phrase }}'{% endtrans %}</h2>
        {% else %}
            <h2>{{ _('Nothing to search for') }}.</h2>
            <p>{{ _('Please try something') }}.</p>
        {% endif %}
    </header>
    {% macro result(object) %}
        <section>
            <div>
                {% if object.kind == 'Photo' %}
                    <i class="fa fa-camera fa-2x pull-left"></i>
                    <h3><a href="{{ object.link }}?find={{ phrase }}">{{ object.headline }}</a></h3>
                    {{ object.body }}
                    <p class="details">
                        {% for tag in object.tags|split %}
                            {% if loop.first %}<i class="fa fa-tags"></i>{% endif %}
                            <a href="{{ uri_for('photo_filter_all', field='tags', value=tag) }}">
                                {{ tag }}</a>{% if not loop.last %},{% endif %}
                        {% endfor %}
                        <i class="fa fa-user"></i>
                        <a href="{{ uri_for('photo_filter_all', field='author', value=object.author) }}"
				            title="{{ _("author's photos") }}">{{ object.author }}</a>
                        <time datetime='{{ object.date|to_datetime }}'>{{ object.date|to_date }}</time>
                    </p>

                {% elif object.kind == 'Entry' %}
                    <i class="fa fa-file-text fa-2x pull-left"></i>
                    <h3><a href="{{ object.link }}?find={{ phrase }}">{{ object.headline }}</a></h3>
                    {{ object.body }}
                    <p class="details">
                        {% for tag in object.tags|split %}
                            {% if loop.first %}<i class="fa fa-tags"></i>{% endif %}
                            <a href="{{ uri_for('entry_filter_all', field='tags', value=tag) }}">
                                {{ tag }}</a>{% if not loop.last %},{% endif %}
                        {% endfor %}
                        <i class="fa fa-user"></i>
                        <a href="{{ uri_for('entry_filter_all', field='author', value=object.author) }}"
				            title="{{ _("author's blogs") }}">{{ object.author }}</a>
                        <time datetime='{{ object.date|to_datetime }}'>{{ object.date|to_date }}</time>
                    </p>
                {% elif object.kind == 'Comment' %}
                    <i class="fa fa-comment fa-2x pull-left"></i>
                    {% if object.headline %}
                        <h3><a href="{{ object.link }}?find={{ phrase }}">{{ object.headline }} ({{ _('comment') }})</a></h3>
                    {% else %}
                        <h3>{{ _('message') }}</h3>
                    {% endif %}
                    {{ object.body }}
                    <p class="details">
                        <i class="fa fa-user"></i>
                        <a href="{{ uri_for('comment_filter_all', field='author', value=object.author) }}"
				            title="{{ _("author's comments") }}">{{ object.author }}</a>
                        <time datetime='{{ object.date|to_datetime }}'>{{ object.date|to_date }}</time>
                    </p>
                {% endif %}
            </div>
        </section>
    {% endmacro %}
    <article class="cols">
        {% for object in objects %}
            {{ result(object) }}
        {% else %}
            <section>
                <div class="box">
                    <h3>{{ _('No search results for') }} {{ phrase }}.</h3>
                    <p>{{ _('Please try again') }}.</p>
                    {% if error %}
                        <p>{{ _('Error') }}: {{ error }}</p>
                    {% endif %}
                </div>
            </section>
        {% endfor %}
    </article>
</div>
{% endblock %}
{% block scripts %}
    {{ super() }}
    <script src="/static/scripts/jquery.searchhighlight.min.js"></script>
{% endblock %}