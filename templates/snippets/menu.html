{% macro _build(filters, kind) %}
    <div class="submenu">
        {% for f in filters %}
            <a class="{{ f.field }} block collapse" href="/filter/{{ kind }}_{{ f.field }}">{{ f.title }} [+]</a>
            <div id="{{ f.field }}cloud" class="hide"></div>
        {% endfor %}
    </div>
{% endmacro %}

{% set _tags = {'field': 'tags', 'title': _('Tags')} %}
{% set _date = {'field': 'date', 'title': _('Dates')} %}
{% set _author = {'field': 'author', 'title': _('Authors')} %}
{% set _color = {'field': 'color', 'title': _('Color')} %}
{% set _model = {'field': 'model', 'title': _('Camera model')} %}
{% set _lens = {'field': 'lens', 'title': _('Lens type')} %}
{% set _eqv = {'field': 'eqv', 'title': _('Eqv. focal length')} %}
{% set _iso = {'field': 'iso', 'title': _('Sensitivity')} %}
{% set _forkind = {'field': 'forkind', 'title': _('Type')} %}

<ul class="fa-ul">
    <li{{ {'class': 'active' if kind == 'Photo'}|xmlattr }}>
        <a href="{{ uri_for('photo_all', page=1) }}" title="{{ _('Photos') }}"><i class="fa fa-camera"></i></a></li>
    <li{{ {'class': 'active' if kind == 'Entry'}|xmlattr }}>
        <a href="{{ uri_for('entry_all', page=1) }}" title="{{ _('Blog') }}"><i class="fa fa-file-text"></i></a></li>
    <li{{ {'class': 'active' if kind == 'Comment'}|xmlattr }}>
        <a href="{{ uri_for('comment_all', page=1) }}" title="{{ _('Comments') }}"><i class="fa fa-comment"></i></a></li>
    <li{{ {'class': 'active' if kind == 'Feed'}|xmlattr }}>
        <a href="{{ uri_for('feed_all', page=1) }}" title="{{ _('News') }}"><i class="fa fa-rss-square"></i></a></li>
    {% if user %}
        <li{{ {'class': 'active' if kind == 'Admin'}|xmlattr }}>
            <a href="/admin/" title="{{ _('Administration') }}"><i class="fa fa-cog"></i></a></li>
    {% else %}
        <li><a href="/sign" title="{{ _('Log in') }}"><i class="fa fa-sign-in"></i></a></li>
    {% endif %}
</ul>

{% if kind == 'Photo' %}
    <h3>{{ _('Photos') }}</h3>
    {{ _build([_tags, _date, _author, _color, _model, _lens, _eqv, _iso], kind) }}
{% elif kind == 'Entry' %}
    <h3>{{ _('Blog') }}</h3>
    {{ _build([_tags, _date, _author], kind) }}
{% elif kind == 'Comment' %}
    <h3>{{ _('Comments') }}</h3>
    {{ _build([_forkind, _date, _author], kind) }}
{% elif kind == 'Feed' %}
    <h3>{{ _('News') }}</h3>
    {{ _build([_tags], kind) }}
{% elif kind == 'Admin' and user %}
    <h3>{{ _('Administration') }}</h3>
    <div class="submenu">
        <a href="{{ uri_for('photo_admin', page=1) }}" class="block">Photo administration</a>
        <a href="{{ uri_for('entry_admin', page=1) }}" class="block">Entry administration</a>
        <a href="{{ uri_for('feed_admin') }}" class="block">Feed administration</a>
        <a href="{{ uri_for('comment_admin', page=1) }}" class="block">Comment &amp; message administration</a>
        {% if is_admin %}
            <a href="{{ uri_for('counter_admin', page=1) }}" class="block">Counters</a>
            <a href="/mapreduce" class="block">Mapreduce</a>
        {% endif %}
        <a href="/invalidate" class="block">{{ _('Invalidate cache') }}</a>
        <a href="/sign" class="block">{{ _('Log out') }}</a>
    </div>
{% endif %}