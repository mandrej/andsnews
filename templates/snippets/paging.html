{% macro _link(name, page, class) %}
    {% set uriname='%s_filter' % name if filter else name %}
    {% set qs='?find=%s&page=%s' % (phrase, page) if phrase else '?page=%s' % page %}

    {% if filter %}
        {% if slug %}
            {% set url = uri_for(uriname, field=filter.field, value=filter.value, slug=slug) %}
        {% else %}
            {% set url = uri_for(uriname, field=filter.field, value=filter.value) %}
        {% endif %}
    {% else %}
        {% if slug %}
            {% set url = uri_for(uriname, slug=slug) %}
        {% else %}
            {% set url = uri_for(uriname) %}
        {% endif %}
    {% endif %}

    <a{{ {'href': '%s%s' % (url, qs), 'class': class}|xmlattr }}></a>
{% endmacro %}

{% if has_previous or has_next %}
    {% if has_previous %}
        {{ _link(name, page - 1, prev_class) }}
    {% else %}
        <span class="{{ prev_class }} na"></span>
    {% endif %}
    {% if has_next %}
        {{ _link(name, page + 1, next_class) }}
    {% else %}
        <span class="{{ next_class }} na"></span>
    {% endif %}
{% endif %}
