{% macro input(field) %}
    {{ field(**kwargs) }}
    {% if field.errors %}
        <span class="error C_{{ field.name }}">{{ field.errors|join(', ') }}</span>
    {% endif %}
{% endmacro %}

{% macro form_row(field) %}
    <p>
        {{ field.label(class='required' if field.flags.required else '') }}
        {% call input(field, **kwargs) %}{% endcall %}
    </p>
{% endmacro %}

{% macro chip(url, classes=[], icon=None, title=None, text='') %}
    {% set classes=['chip'] + classes %}
    <div class="{{ classes|css_classes }}">
        {% if icon %}{{ icon|safe }}{% endif %}
        <a{{ {'href': url, 'title': title}|xmlattr }}>{{ text }}</a>
    </div>
{% endmacro %}

{% macro menu(kind=None) %}
{#    {% if kind == 'none' %}#}
{#        <li class="active no-padding"><a href="{{ uri_for('front') }}" class="waves-effect">{{ _('About') }}</a></li>#}
{#    {% else %}#}
{#        <li class="no-padding"><a href="{{ uri_for('front') }}" class="waves-effect">{{ _('About') }}</a></li>#}
{#    {% endif %}#}
    {% if kind == 'photo' %}
        <li class="active no-padding">
            <a href="#filters" class="waves-effect modal-trigger">{{ _('Photos') }}</a>
        </li>
    {% else %}
        <li class="no-padding"><a href="{{ uri_for('photo_all') }}" class="waves-effect">{{ _('Photos') }}</a></li>
    {% endif %}
    {% if kind == 'entry' %}
        <li class="active no-padding">
            <a href="#filters" class="waves-effect modal-trigger">{{ _('Texts') }}</a>
        </li>
    {% else %}
        <li class="no-padding"><a href="{{ uri_for('entry_all') }}" class="waves-effect">{{ _('Texts') }}</a></li>
    {% endif %}
    {% if user %}
        {% if kind == 'admin' %}
            <li class="active no-padding">
                <a href="{{ uri_for('admin_all') }}" class="waves-effect">{{ _('Admin') }}</a>
            </li>
        {% else %}
            <li class="no-padding">
                <a href="{{ uri_for('admin_all') }}" class="waves-effect">{{ _('Admin') }}</a>
            </li>
        {% endif %}
    {% else %}
        <li class="no-padding">
            <a href="/sign" class="waves-effect">{{ _('Login') }}</a>
        </li>
    {% endif %}
{% endmacro %}

{% macro filters_html(available, kind) %}
    <div id="filters" class="modal bottom-sheet">
        <div class="modal-content">
            <div class="row valign-wrapper">
                <div class="col s4">
                    <span class="btn-floating waves-effect grey"><i class="material-icons">filter_list</i></span>
                </div>
                <div class="col s4 center-align valign middle card-title">{{ _('Filters') }}</div>
                <div class="col s4">
                    <a href="{{ uri_for('%s_all' % kind) }}"
                        class="btn-floating waves-effect right"><i class="material-icons">clear_all</i>
                    </a>
                </div>
            </div>
            <div class="row" style="margin-top: 1rem;">
                {% for f in available %}
                    <div class="col s12 m6">
                        {% set url = '/filter/%s_%s' % (kind.capitalize(), f.field) %}
                        <a class="{{ f.field }} collapse" href="{{ url }}">{{ f.title }}</a>
                        <div id="{{ f.field }}cloud" class="hidden"></div>
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect btn-flat">close</a>
        </div>
    </div>
{% endmacro %}

{% macro filters(kind=None) %}
    {% set _tags = {'field': 'tags', 'title': _('Tags')} %}
    {% set _date = {'field': 'date', 'title': _('Dates')} %}
    {% set _author = {'field': 'author', 'title': _('Authors')} %}
    {% set _color = {'field': 'color', 'title': _('Color')} %}
    {% set _model = {'field': 'model', 'title': _('Camera model')} %}
    {% set _lens = {'field': 'lens', 'title': _('Lens type')} %}
    {% set _iso = {'field': 'iso', 'title': _('Sensitivity')} %}

    {% if kind == 'photo' %}
        {{ filters_html([_tags, _date, _author, _color, _model, _lens, _iso], kind) }}
    {% endif %}
    {% if kind == 'entry' %}
        {{ filters_html([_tags, _date, _author], kind) }}
    {% endif %}
{% endmacro %}
