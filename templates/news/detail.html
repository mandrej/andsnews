{% extends "news/base.html" %}
{% load tags i18n %}
{% block title %}{{ block.super }} - {{ object.headline }}{% endblock %}

{% block subnav %}
    {% if is_admin %}
        <a href="/news/add" title="{% trans 'Add' %}">{% trans 'Add' %}</a>
        <a href="{{ object.get_absolute_url }}/edit" title="{% trans 'Edit' %}">{% trans 'Edit' %}</a>
        <a class="confirm" href="{{ object.get_absolute_url }}/delete" title="{% trans 'Delete' %}">{% trans 'Delete' %}</a>
    {% endif %}
{% endblock %}

{% block contents %}
<article class="plain nomargin">
	{% if error %}
		{% popup error %}
			<p>{% trans 'News error' %}.<br/>{{ error }}.</p>
		{% endpopup %}
	{% endif %}
	
	{% if news %}
		<h2><a href="{{ news.feed.link }}">{{ object.headline }}</a></h2>
	
		{% if news.feed.subtitle or news.feed.rights %}
			<p class="copyright">
				{% if news.feed.subtitle %}
					<strong>{{ news.feed.subtitle|safe }}</strong>
				{% endif %}
				{{ news.feed.rights }}
			</p>
		{% endif %}
		<div class="subtitle">
			{{ news.version|upper }}{# if news.feed.generator %} {{ news.feed.generator }}{% endif #},
	
			{% if object.date %}{% trans 'updated' %}:
				<time datetime="{{ object.date|date:"Y-m-d\TH:i:sO" }}">
					{% blocktrans with object.date|timesince as since %}{{ since }} ago{% endblocktrans %}
				</time>
			{% endif %}
			{% for tag in object.tags %}
				{% if forloop.first %}| {% trans 'tagged by' %}:{% endif %}
				<a href="/news/tags/{{ tag }}" title="{{ tag }}">
					{{ tag }}</a>{% if not forloop.last %},{% endif %}
			{% endfor %}
		</div>
		
		<div id="container">
			{% for entry in news.entries|dictsortreversed:"date" %}
				<article class="third brick">
		            <div class="white">
		                <header>
		                    <h3><a href="{{ entry.link }}">{{ entry.title|safe }}</a></h3>
		                </header>
		                <div class="story">{{ entry.content|safe }}</div>
		                <p class="details">
		                    {{ entry.author|striptags }}
		                    {% if entry.date %}
		                        {% blocktrans with entry.date|timesince as since %}{{ since }} ago{% endblocktrans %}
		                    {% endif %}
		                </p>
		            </div>
				</article>
			{% endfor %}
		</div>
	{% else %}
		<h2>{% blocktrans with object.headline as headline %}No {{ headline }} at the moment{% endblocktrans %}.</h2>
	{% endif %}
</article>
{% endblock %}
