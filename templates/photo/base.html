{% extends "base.html" %}
{% block nav %}
    {% set _tags = {'field': 'tags', 'title': _('Tags')} %}
    {% set _date = {'field': 'date', 'title': _('Dates')} %}
    {% set _author = {'field': 'author', 'title': _('Authors')} %}
    {% set _color = {'field': 'color', 'title': _('Color')} %}
    {% set _model = {'field': 'model', 'title': _('Camera model')} %}
    {% set _lens = {'field': 'lens', 'title': _('Lens type')} %}
    {% set _eqv = {'field': 'eqv', 'title': _('Eqv. focal length')} %}
    {% set _iso = {'field': 'iso', 'title': _('Sensitivity')} %}

    <ul class="fa-ul">
        <li>
            <h2>
                <a class="selected" href="{{ uri_for('photo_all', page=1) }}">
                    <i class="fa fa-li fa-camera"></i>
                    {{ _('Photos') }}
                </a>
            </h2>
            <div class="submenu">
                {% for f in [_tags, _date, _author, _color, _model, _lens, _eqv, _iso] %}
                    <a class="{{ f.field }} block collapse" href="/filter/Photo_{{ f.field }}">{{ f.title }} [+]</a>
                    <div id="{{ f.field }}cloud" class="hide"></div>
                {% endfor %}
            </div>
        </li>
        <li>
            <h2>
                <a href="{{ uri_for('entry_all', page=1) }}">
                    <i class="fa fa-li fa-file-text"></i>
                    {{ _('Blog') }}
                </a>
            </h2>
        </li>
        <li>
            <h2>
                <a href="{{ uri_for('admin_all') }}">
                    <i class="fa fa-li fa-cog"></i>
                    {{ _('Administration') }}
                </a>
            </h2>
        </li>
    </ul>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        $(function () {
            var filter = {{ filter|to_json }};
            if (filter) {
                $('.hide').hide();
                $('.collapse').each(function() {
                    $(this).plus();
                });
                $.ajax({
                    url: '/filter/Photo_' + filter.field + '/' + filter.value,
                    context: $('#' + filter.field + 'cloud'),
                    success: function(snippet) {
                        $(this).html(snippet).slideDown();
                        $('.' + filter.field).minus();
                    }
                });
            }

            var $container = $('article.thumbnails');
            $container.infinitescroll({
                binder: $(window),
                itemSelector: 'figure',
                nextSelector: '.next',
                navSelector: "nav.paginator",
                loading: {
                    selector: '#spinner'
                }
            });
        });
    </script>
{% endblock %}