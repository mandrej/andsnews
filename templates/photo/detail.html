{% extends "photo/base.html" %}
{% import "snippets/macros.html" as m %}
{% block paging %}{% endblock %}

{% block title %}{{ super() }} - {{ object.headline }}{% endblock %}
{% block meta %}<meta name="date" content="{{ object.date|to_date }}"/>{% endblock %}

{% block modals %}
{{ super() }}
<div id="addcomment" class="modal"></div>
{% endblock %}

{% block contents %}
<div id="container">
    <div class="swiper-container">
        <div class="swiper-wrapper">
            {% for obj in [previous, object, next] %}
                <div class="swiper-slide" data-slug="{{ obj.key.string_id() }}">
                    {% include 'photo/detail_page.html' %}
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <link type="text/css" rel="stylesheet" href="/static/scripts/markitup/skins/simple/style.css"/>
    <link type="text/css" rel="stylesheet" href="/static/scripts/markitup/sets/buttons.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/1.2.1/jquery-migrate.js"></script>
    <script src="/static/scripts/base.min.js"></script>
    <script src="/static/scripts/jquery.searchhighlight.min.js"></script>
    <script src="/static/scripts/markitup/jquery.markitup.min.js"></script>
    <script src="/static/scripts/markitup/sets/cmnt.set_{{ language_code }}.min.js"></script>
    <script src="/static/scripts/idangerous.swiper.min.js"></script>
    <script>
        $(function() {
            var mySwiper = new Swiper('.swiper-container', {
                speed: 500,
                loop: false,
                grabCursor: true,
                calculateHeight: true,
                keyboardControl: true,
                watchActiveIndex: true,
                initialSlide: 1
{#                onTouchStart: appendSlide,#}
{#                onSlideNext: appendSlide#}
            });
{#            function appendSlide(swiper, url, slug) {#}
{#                var xhr = $.get(url)#}
{#                    .done(function(data) {#}
{#                        var newSlide = swiper.createSlide(data);#}
{#                        newSlide.data('slug', slug);#}
{#                        newSlide.append();#}
{#                        swiper.reInit();#}
{#                    });#}
{#            }#}
{#            $.when($.get('{{ previous_url }}'), $.get('{{ object_url }}'), $.get('{{ next_url }}'))#}
{#                .done(function(a1, a2, a3) {#}
{#                    var newSlide;#}
{#                    newSlide = mySwiper.createSlide(a1[0]);#}
{#                    newSlide.data('slug', '{{ previous.key.string_id() }}');#}
{#                    newSlide.append();#}
{##}
{#                    newSlide = mySwiper.createSlide(a2[0]);#}
{#                    newSlide.data('slug', '{{ object.key.string_id() }}');#}
{#                    newSlide.append();#}
{##}
{#                    newSlide = mySwiper.createSlide(a3[0]);#}
{#                    newSlide.data('slug', '{{ next.key.string_id() }}');#}
{#                    newSlide.append();#}
{##}
{#                    mySwiper.params.initialSlide = 2;#}
{#                    mySwiper.reInit();#}
{#                });#}
{#            appendSlide(mySwiper, '{{ previous_url }}', );#}
{#            appendSlide(mySwiper, '{{ object_url }}', '{{ object.key.string_id() }}');#}
{#            appendSlide(mySwiper, '{{ next_url }}', '{{ next.key.string_id() }}');#}
        });
    </script>
{% endblock %}