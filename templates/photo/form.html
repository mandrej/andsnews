{% extends "photo/base.html" %}

{% block title %}{{ super() }} - {{ _('Add new / change existing photo') }}{% endblock %}

{% block subnav %}
    {% if object %}
        {% if is_admin or user == object.author %}
			<a class="confirm" href="{{ object.get_absolute_url }}/delete" title="{{ _('Delete') }}">{{ _('Delete') }}</a>
     		<a href="{{ object.get_absolute_url }}" title="{{ _('Back') }}">{{ _('Back') }}</a>
        {% endif %}
    {% else %}
        <a href="/photos" title="{{ _('Back') }}">{{ _('Back') }}</a>
    {% endif %}
{% endblock %}

{% block head %}
{{ super() }}
<script src="/static/scripts/urlify.js"></script>
<script src="/static/scripts/jquery.autocomplete.js"></script>
<script src="/static/scripts/jquery.filestyle.js"></script>
<script src="/jsi18n/"></script>
<script src="/static/admin/js/core.js"></script>
<script src="/static/admin/js/calendar.js"></script>
<script src="/static/admin/js/admin/DateTimeShortcuts.js"></script>
<script>
	$().ready(function() {
		$('#headline').slugify();
		$('input, select').focusHighlight();
		var lang = '{{ LANGUAGE_CODE }}';
		$('input:file').filestyle({
			image: '/static/images/choose-' + lang + '.png',
			imageheight : 27,
			imagewidth : 77,
			width : 202
		}).hover(
				function() {$(this).parent().css({'background-position': '0 -27px'});},
				function() {$(this).parent().css({'background-position': '0 0'});}
		);
		$("#tags").autocomplete("/complete/photo/tags", {
			width: 284,
			selectFirst: false,
			multiple: true,
			matchContains: true
		});
        $("#lens").autocomplete("/complete/photo/lens", {
			width: 284,
			selectFirst: false,
			multiple: false,
			matchContains: true
		});
		$('#main button').click(function() {
			$('#overlay, #spinner').show();
		});
	});
</script>
{% endblock %}

{% block aside %}
	<p>{{ _('<strong>Slug</strong> uniquely represent record. It must start with letter and may contain only letters, numbers, underscores or hyphens. It is used for URL addresses.') }}</p>
	<p>{{ _('<strong>Tags</strong> determine record qualification to a group or a type of records. It is comma separated. Use english for wider understanding.') }}</p>
	<p>{{ _('<strong>Forward slash</strong> is not allowed in any field. It will be stripped out automatically.') }}</p>
	<p><strong>{{ _('Send photo less then') }} 1MB.</strong></p>

	<p>{{ _('<strong>Crop factor</strong> represent dimensional ratio between sensor and the 35 mm film camera (36x24mm)') }}:</p>
	<table>
		<tr><th>Senesor size</th><th>Crop factor</th></tr>
		<tr><td>Full format</td><td>1.0 (Contax 137 MD Quartz)</td></tr>
		<tr><td>APS-H</td><td>1.3</td></tr>
		<tr><td>Nikon DX</td><td>1.5 (NIKON D80)</td></tr>
		<tr><td>Canon APS-C</td><td>1.6 (Canon EOS 400D)</td></tr>
		<tr><td>Four-thirds</td><td>2.0</td></tr>
		<tr><td>1/1.7"</td><td>4.6 (Canon PowerShot A80)</td></tr>
		<tr><td>1/1.8"</td><td>4.8</td></tr>
		<tr><td>1/2.5"</td><td>5.6 (Canon IXUS 115 HS)</td></tr>
		<tr><td>1/2.7"</td><td>6.6 (OLYMPUS IR-500)</td></tr>
	</table>
	<p><strong>{{ _('Date format') }} &quot;yyyy-mm-dd hh:mm:ss&quot;</strong></p>
{% endblock %}

{% block contents %}
<article>
	<h2>{{ _('Add new / change existing photo') }}</h2>
{#	{% if form.errors %}#}
{#		<div class="formerrors">#}
{#			<p>{{ _('Please correct errors in') }}#}
{#			{{ form.errors|join:", " }}.</p>#}
{#		</div>#}
{#	{% endif %}#}

    {% if upload_url %}
        <form action="{{ upload_url }}" enctype="multipart/form-data" method="post">
            <fieldset>
                <h3>{{ _('Step') }} 1/2</h3>
                <p>{{ form.headline.label }}{{ form.headline() }}</p>
                <p>{{ form.slug.label }}{{ form.slug() }}</p>
                <p>{{ form.tags.label }}{{ form.tags() }}</p>
                {% if is_admin %}
                    <p>{{ form.author.label }}{{ form.author() }}</p>
                {% else %}
                    <input type="hidden" name="author" value="{{ object.author.email }}"/>
                {% endif %}
                <p>{{ form.photo.label }}{{ form.photo() }}</p>
                <p class="buttons">
                    <span class="required">{{ _('Required field') }}</span>
{#                    {{ form.submit() }}#}
                    <button type="submit">{{ _('upload') }}</button>
                </p>
            </fieldset>
        </form>
    {% endif %}

	{% if object %}
	    <form action="{{ object.get_absolute_url }}/edit" method="post">
			<fieldset>
                <h3>{{ _('Step') }} 2/2</h3>
                <p>{{ form.headline.label }}{{ form.headline() }}</p>
                <p>{{ form.tags.label }}{{ form.tags() }}</p>
				{% if is_admin %}
                    <p>{{ form.author.label }}{{ form.author() }}</p>
				{% else %}
					<input type="hidden" name="author" value="{{ object.author.email }}"/>
				{% endif %}
			</fieldset>
			
			<fieldset>
				<h3>EXIF {{ _('data') }}</h3>
                <p>{{ form.model.label }}{{ form.model() }}</p>
                <p>{{ form.lens.label }}{{ form.lens() }}</p>
                <p>{{ form.aperture.label }}{{ aperture.lens() }}</p>
                <p>{{ form.shutter.label }}{{ aperture.shutter() }}</p>
                <p>{{ form.focal_length.label }}{{ aperture.focal_length() }}</p>
                <p>{{ form.crop_factor.label }}{{ aperture.crop_factor() }}</p>
                <p>{{ form.iso.label }}{{ aperture.iso() }}</p>
                <p>{{ form.date.label }}{{ aperture.date() }}</p>
				<p class="buttons">
					<span class="required">{{ _('Required field') }}</span>
					<button type="submit">{{ _('done') }}</button>
				</p>
			</fieldset>
		</form>
	{% endif %}
</article>
{% endblock %}

{% block ga %}{% endblock %}
