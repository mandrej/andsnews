{% extends "photo/base.html" %}
{% block meta %}<meta name="date" content="{{ objects.0.date|format_date }}"/>{% endblock %}
{% block title %}{{ super() }} - {{ _('Photos') }}{% endblock %}

{% block subnav %}
    {% if user %}
        <a href="/photos/add" class="add" title="{{ _('Add') }}">{{ _('Add') }}</a>
    {% endif %}
{% endblock %}

{% block contents %}
	{% if objects %}
		<h2><a href="/photos">{{ _('Photos') }}</a>{{ filter_title }}{% if page != 1 %} [{{ page }}]{% endif %}</h2>
	{% else %}
		<h2>{{ _('No photos submitted') }}, {{ _('or filter has no results') }}.</h2>
	{% endif %}

	<div id="container">
		{% for object in objects %}
			<figure class="thumbnail brick">
				<a href="/photos{{ filter_url }}/{{ object.key.string_id() }}?page={{ page }}&pic={{ loop.index }}"
					title="{{ object.headline }}">
                    <img data-url="{{ object.small_url() }}"/>
                    <p class="legend">{{ object.headline }}</p>
				</a>
			</figure>
		{% endfor %}
	</div>
    <script>
        $('figure img').each(function() {
            var cntx = $(this);
            cntx.attr('src', cntx.attr('data-url'))
                .load(function() {
                    cntx.append();
                })
        })
    </script>
{% endblock %}
