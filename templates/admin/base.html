{% extends "base.html" %}
{% block nav %}
    <h3><a href="{{ uri_for('photo_all', page=1) }}">{{ _('Photos') }}</a></h3>
    <h3><a href="{{ uri_for('entry_all', page=1) }}">{{ _('Blog') }}</a></h3>
    <h3><a class="selected" href="{{ uri_for('admin_all') }}">{{ _('Administration') }}</a></h3>
    {% if user %}
        <div class="submenu">
            <a href="/sign" class="block">{{ _('Log out') }}</a>
        </div>
    {% endif %}
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        (function($) {
            function split(val) {
                return val.split(/,\s*/);
            }
            function extractLast(term) {
                return split(term).pop();
            }
            $.fn.multicomplete = function(options) {
                var defaults = {minLength: 2};
                var opts = $.extend({}, defaults, options);
                return this.each(function() {
                    $(this).bind('keydown', function(event) {
                        if (event.keyCode === $.ui.keyCode.TAB && $(this).autocomplete('instance').menu.active ) {
                            event.preventDefault();
                        }
                    }).autocomplete({
                        source: function(request, response) {
                            $.getJSON(opts.source, {
                                term: extractLast(request.term)
                            }, response);
                        },
                        search: function() {
                            var term = extractLast(this.value);
                            if (term.length < opts.minLength) {
                                return false;
                            }
                        },
                        focus: function(event, ui) {
                            return false;
                        },
                        select: function(event, ui) {
                            var terms = split(this.value);
                            terms.pop();
                            terms.push(ui.item.value);
                            terms.push('');
                            this.value = terms.join(', ');
                            return false;
                        }
                    });
                });
            };
        })(jQuery);
    </script>
{% endblock %}

{% block ga %}{% endblock %}