{% extends "base.html" %}
{% import "snippets/macros.html" as m %}

{% block modals %}
    <div id="graph" class="modal bottom-sheet"></div>
    <div id="confirm" class="modal bottom-sheet"></div>
{% endblock %}

{% block menu %}{{ m.menu('admin') }}{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.12/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.css" rel="stylesheet">
    <script>
        (function($) {
            function split(val) {
                return val.split(/,\s*/);
            }
            function extractLast(term) {
                return split(term).pop();
            }
            $.fn.multicomplete = function(options) {
                var defaults = {minLength: 2};
                var opts = $.extend({}, defaults, options);
                return this.each(function() {
                    $(this).bind('keydown', function(event) {
                        if (event.keyCode === $.ui.keyCode.TAB && $(this).autocomplete('instance').menu.active ) {
                            event.preventDefault();
                        }
                    }).autocomplete({
                        source: function(request, response) {
                            $.getJSON(opts.source, {
                                term: extractLast(request.term)
                            }, response);
                        },
                        search: function() {
                            var term = extractLast(this.value);
                            if (term.length < opts.minLength) {
                                return false;
                            }
                        },
                        focus: function(event, ui) {
                            return false;
                        },
                        select: function(event, ui) {
                            var terms = split(this.value);
                            terms.pop();
                            terms.push(ui.item.value);
                            terms.push('');
                            this.value = terms.join(', ');
                            return false;
                        }
                    });
                });
            };
        })(jQuery);
    </script>
{% endblock %}

{% block ga %}{% endblock %}