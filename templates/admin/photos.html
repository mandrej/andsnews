{% extends "admin/base.html" %}
{% import "snippets/macros.html" as m %}

{% block contents %}
{{ super() }}
<article>
	<h2>Photo administration {{ m.page_number(page) }}</h2>
    <section>
        <h3>Dates</h3>
        <p class="cloud">
            {% for item in archive|sort(attribute='name', reverse=True) %}
                {% if filter %}{% set selected = item.name == filter.value|int %}{% endif %}
                <a class="{{ ['t%s' % item.size, 'selected' if selected]|css_classes }}"
                    title="{{ item.count }}" href="/admin/blobs/date/{{ item.name }}">{{ item.name }}</a>
            {% endfor %}
        </p>
    </section>

    <br clear="all"/>
    <table id="data1" class="zebra">
        <colgroup>
            <col/>
            <col style="width: 190px; text-align: right;"/>
            <col style="width: 120px; text-align: right;"/>
            <col style="width: 210px; text-align: right;"/>
            <col style="width: 120px; text-align: right;"/>
        </colgroup>
        <thead>
            <tr>
                <th>headline</th>
                <th>blob info</th>
                <th>HLS</th>
                <th>color classification</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for object in objects %}
                {% if user == object.author or is_admin %}
                    <tr id="{{ object.key.urlsafe() }}">
                        <td>
                            <a href="{{ uri_for('photo', slug=object.key.string_id()) }}">
                                {{ object.headline }}
                            </a>
                        </td>
                        <td>
                            {% if object.blob_key %}
                                {{ True|boolimage }}
                                {{ object.blob_info.size|filesizeformat }}, {{ object.blob_info.content_type }}
                            {% else %}
                                {{ False|boolimage }}
                            {% endif %}
                        </td>
                        <td>
                            <span class="_hex" style="display: inline-block; width: 1.5em; background-color: {{ object.hex }};">&nbsp;</span>
                            {% for c in object.hls %}{{ '%03d'|format(c) }} {% endfor %}
                        </td>
                        <td>
                            {{ object.hue }}, {{ object.lum }}, {{ object.sat }}
                        </td>
                        <td>
                            <a class="button" href="{{ uri_for('photo_edit', slug=object.key.string_id()) }}">
                                <i class="fa fa-pencil-square"></i> edit</a>
                            <a class="confirm button delete" href="{{ uri_for('delete', safe_key=object.key.urlsafe()) }}">
                                <i class="fa fa-times-circle"></i> delete</a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</article>
{% endblock %}
{% block scripts %}
    {{ super() }}
    <script>
        nbl.l([[
            'https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js',
            'https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/1.2.1/jquery-migrate.js',
            '/static/scripts/common.min.js']]);
    </script>
{% endblock %}