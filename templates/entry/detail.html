{% extends "entry/base.html" %}
{% import "snippets/macros.html" as m %}

{% block title %}{{ super() }} - {{ object.headline }}{% endblock %}
{% block meta %}<meta name="date" content="{{ object.date|to_date }}"/>{% endblock %}

{% block modals %}
{{ super() }}
<div id="addcomment" class="modal"></div>
{% endblock %}

{% block contents %}
<aside>
    <nav class="submenu">
        <h2>
            {% if user %}
                <a href="{{ uri_for('entry_add') }}" title="{{ _('Add') }}">{{ _('Add') }}</a>
                <a class="comment_add" href="{{ uri_for('comment_add', safe_key=object.key.urlsafe()) }}" title="{{ _('Comment') }}">{{ _('Comment') }}</a>
            {% endif %}
            {% if object %}
                {% if is_admin %}
                    <a href="{{ uri_for('entry_edit', slug=object.key.string_id()) }}" title="{{ _('Edit') }}">{{ _('Edit') }}</a>
                    <a class="confirm" href="{{ uri_for('delete', safe_key=object.key.urlsafe()) }}" title="{{ _('Delete') }}">{{ _('Delete') }}</a>
                {% else %}
                    {% if user == object.author %}
                        <a href="{{ uri_for('entry_edit', slug=object.key.string_id()) }}" title="{{ _('Edit') }}">{{ _('Edit') }}</a>
                        <a class="confirm" href="{{ uri_for('delete', safe_key=object.key.urlsafe()) }}" title="{{ _('Delete') }}">{{ _('Delete') }}</a>
                    {% endif %}
                {% endif %}
                <a href="{{ uri_for('entry_all') }}" title="{{ _('Back') }}">{{ _('Back') }}</a>
            {% endif %}
        </h2>
    </nav>
    <div class="comments">
        {% for comment in object.comment_list() %}
            {{ m.render_comment(comment, user) }}
        {% endfor %}
    </div>
</aside>
<article class="port">
	<header>
		<h2>{{ object.headline }}</h2>
		<div class="subtitle">
            <i class="icon-user"></i>
			<a href="{{ uri_for('entry_filter_all', field='author', value=object.author) }}"
				title="{{ _("author's blogs") }}">{{ object.author }}</a>,
				<time datetime='{{ object.date|to_datetime }}'>
					{{ object.date|to_datetime }}</time>
			{% for tag in object.tags %}
                {% if loop.first %}<i class="icon-tag"></i>{% endif %}
				<a href="{{ uri_for('entry_filter_all', field='tags', value=tag) }}" title="{{ tag }}">
					{{ tag }}</a>{% if not loop.last %},{% endif %}
			{% endfor %}
            <i class="icon-time"></i>
			<a href="{{ uri_for('entry_filter_all', field='date', value=object.year) }}"
			    title="{{ _('blogs sent same year') }}">{{ object.year }}</a>
		</div>
        <i class="icon-quote-left pull-left icon-2x"></i>
        <p>{{ object.summary|safe }}</p>
	</header>
	
	<div class="story">{{ object.body|safe }}</div>
</article>
{% endblock %}