{% extends "entry/base.html" %}
{% import "snippets/macros.html" as m %}

{% block title %}{{ super() }} - {{ object.headline }}{% endblock %}
{% block meta %}<meta name="date" content="{{ object.date|to_date }}"/>{% endblock %}

{% block modals %}
{{ super() }}
<div id="addcomment" class="modal"></div>
{% endblock %}

{% block contents %}
<h2>{{ object.headline }}</h2>
<div class="subtitle">
    <i class="icon-user"></i>
    <a href="{{ uri_for('entry_filter_all', field='author', value=object.author) }}"
        title="{{ _("author's blogs") }}">{{ object.author }}</a>,
        <time datetime='{{ object.date|to_datetime }}'>
            {{ object.date|to_datetime }}</time>
    {% for tag in object.tags %}
        {% if loop.first %}<i class="icon-tag"></i>{% endif %}
        <a href="{{ uri_for('entry_filter_all', field='tags', value=tag) }}" title="{{ tag }}">
            {{ tag }}</a>{% if not loop.last %},{% endif %}
    {% endfor %}
    <i class="icon-time"></i>
    <a href="{{ uri_for('entry_filter_all', field='date', value=object.year) }}"
        title="{{ _('blogs sent same year') }}">{{ object.year }}</a>
</div>

<div id="container" class="port">
    <article>
        <i class="icon-quote-left pull-left icon-2x"></i>
        <p>{{ object.summary|safe }}</p>
        <div class="story">{{ object.body|safe }}</div>
    </article>
    <aside>
        <div class="comments">
            {% for comment in object.comment_list() %}
                {{ m.render_comment(comment, user) }}
            {% endfor %}
            {% if user %}
                <p><a class="comment_add" href="{{ uri_for('comment_add', safe_key=object.key.urlsafe()) }}" title="{{ _('Add Comment') }}">{{ _('Add Comment') }}</a></p>
            {% endif %}
        </div>
    </aside>
</div>
{% endblock %}
{% block scripts %}
    <link type="text/css" rel="stylesheet" href="/static/scripts/markitup/skins/simple/style.css"/>
    <link type="text/css" rel="stylesheet" href="/static/scripts/markitup/sets/buttons.css"/>
    {{ super() }}
    <script>
        nbl.l([[
            'https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js',
            '/static/scripts/jquery.searchhighlight.min.js',
            '/static/scripts/markitup/jquery.markitup.min.js',
            '/static/scripts/markitup/sets/cmnt.set_{{ language_code }}.min.js', [
                '/static/scripts/common.min.js',
                '/static/scripts/base.min.js']]]);
    </script>
{% endblock %}