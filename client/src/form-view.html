<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">

<dom-module id="form-view">
    <template>
        <style is="custom-style" include="iron-flex iron-flex-alignment"></style>
        <style>
            :host {
                display: block;
                background-color: #eee;
            }
            .container {
                margin: 16px;
            }
        </style>

        <iron-ajax auto
			url="{{_url(view, kind, field, value)}}"
			handle-as="json"
			last-response="{{obj}}"
			debounce-duration="300"></iron-ajax>

        <div class="container">
            <form is="iron-form" id="form" method="post" action="/form/handler">
                <paper-input name="headline" label="headline" value="{{obj.headline}}"></paper-input>
                <paper-input name="author" label="author" value="{{obj.author}}"></paper-input>
                <!-- <datalist id="tags">
                    <template is="dom-repeat" items="{{obj.tags}}" index-as="index">
                        <option value="{{item}}"></option>
                    </template>
                </datalist>
                <paper-input name="tags" label="tags" list id="tags"></paper-input> -->
                <paper-input name="tags" label="tags" value="{{obj.tags}}"></paper-input>
                <!-- <paper-input name="model" label="model" value="{{obj.model}}"></paper-input>
                <paper-input name="lens" label="lens" value="{{obj.lens}}"></paper-input>
                <paper-input name="aperture" label="aperture" value="{{obj.aperture}}"></paper-input>
                <paper-input name="shutter" label="shutter" value="{{obj.shutter}}"></paper-input>
                <paper-input name="iso" label="iso" value="{{obj.iso}}"></paper-input> -->
            </form>
        </div>
    </template>
    <script>
        Polymer({
            is: 'form-view',
            properties: {
                kind: { type: String, value: null, notify: true },
				field: { type: String, value: null, notify: true },
            },
            _url: function(view, kind, field, value) {
                var url, prefix = '/api';

                if (view != 'form') return url;
                if (field && !value && kind != 'search' ) {
                    url = [prefix, kind, field].join('/');
                }
                return url;
            }
        });
    </script>
</dom-module>
