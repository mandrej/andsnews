<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../styles/shared-styles.html">

<dom-module id="list-grid">
    <template>
        <style is="custom-style" include="shared-styles"></style>
        <style>
            :host {
                display: block;
                padding: 4px;
            }
            .content {
                @apply(--layout-horizontal);
                @apply(--layout-start-aligned);
                @apply(--layout-wrap);
            }
            .photo, .entry {
                position: relative;
                width: 33.3333333%;
				cursor: pointer;
			}
            paper-card {
                padding: 4px;
                /*--paper-card-background-color: var(--google-yellow-100);*/
            }
            .photo {
                height: 250px;
                /*--paper-card-header-color: #fff;*/
            }
            /*@media (max-width: 1024px) { .photo, .entry { width: 25%; } }*/
            @media (max-width: 848px)  { .photo, .entry { width: 33.3333333%; } }
            @media (max-width: 768px)  { .photo, .entry { width: 50%; } }
            @media (max-width: 432px)  { .photo, .entry { width: 100%; } }

            .photo iron-image {
                width: 100%;
                height: 100%;
            }
            .entry iron-image {
                width: 100%;
                height: 50px;
            }
        </style>

        <div class="content">
            <template is="dom-repeat" items="{{items}}" index-as="index" id="repeater">
                <template is="dom-if" if="[[_showPhoto(item)]]">
                    <paper-card class="photo" on-tap="_showDetail" elevation="0">
                        <iron-image src="[[item.serving_url]]=s0" preload sizing="cover"></iron-image>
                        <paper-ripple></paper-ripple>
                    </paper-card>
                </template>
                <template is="dom-if" if="[[!_showPhoto(item)]]">
                    <paper-card heading="[[item.headline]]" class="entry" elevation="0" on-tap="_showDetail">
                        <div class="card-content">
                            <template is="dom-if" if="[[item.front]]" restamp="true">
                                <iron-image src="[[item.front]]/normal" preload sizing="cover"></iron-image>
                            </template>
                            [[item.summary]]
                        </div>
                        <paper-ripple></paper-ripple>
                    </paper-card>
                </template>
            </template>
        </div>

    </template>
    <script>
        Polymer({
            is: 'list-grid',
            properties: {
                items: {
                    type: Array,
                    value: []
                },
                selected: {
                    type: Number,
                    value: 0,
                    notify: true
                }
            },
            _showPhoto: function(item) {
                return item.kind == 'photo';
            },
            _showDetail: function(e) {
                // this.selected = e.model.index; without dom-if
                var model = this.$.repeater.modelForElement(e.target);
                console.log(model.index);
                this.selected = model.index;
                this.fire('show-detail');
            }
        });
    </script>
</dom-module>
