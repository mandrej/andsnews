<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-swipeable-pages/iron-swipeable-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation.html">
<link rel="import" href="../styles/shared-styles.html">

<dom-module id="list-detail">
    <template>
        <style is="custom-style" include="shared-styles"></style>
        <style>
            :host {
                @apply(--layout-fit);
            }
            .swipe {
                -moz-user-select: none;
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
                cursor: default;
            }
            iron-image { width: 100%; height: 100%; }
            /* not working */
            figure { margin 0.5em 0; }
            figure.left { float: left; margin-right: 0.5em; }
            figure.right { float: right; margin-left: 0.5em; }
            figure img { width: 100%; }
        </style>

        <iron-swipeable-pages class="fit" selected="{{selected}}" edgeSwipeSensitivity="15" threshold="0.1">
            <template is="dom-repeat" items="{{items}}">
                <template is="dom-if" if="[[_showPhoto(item)]]">
                    <div class="swipe">
                        <paper-toolbar hidden$="{{!toggleView}}">
                            <paper-icon-button icon="icons:chevron-left" on-tap="_showList"></paper-icon-button>
                            <div class="title">[[item.headline]]</div>
                            <paper-icon-button icon="icons:more-vert" on-tap="_showExif"></paper-icon-button>
                        </paper-toolbar>
                        <paper-dialog id="[[item.slug]]" entry-animation="scale-up-animation" exit-animation="fade-out-animation">
                            <table>
                                <tr><td>date</td><td>[[item.date]]</td></tr>
                                <tr><td>author</td><td>[[item.author]]</td></tr>
                                <tr><td>model</td><td>[[item.model]]</td></tr>
                                <tr><td>lens</td><td>[[item.lens]]</td></tr>
                                <tr><td>eqv</td><td>[[item.eqv]]</td></tr>
                                <tr><td>iso</td><td>[[item.iso]]</td></tr>
                            </table>
                        </paper-dialog>
                        <iron-image src="{{item.serving_url}}=s0" sizing="cover"></iron-image>
                    </div>
                </template>
                <template is="dom-if" if="[[!_showPhoto(item)]]">
                    <div class="swipe">
                        <paper-toolbar hidden$="{{!toggleView}}">
                            <paper-icon-button icon="icons:chevron-left" on-tap="_showList"></paper-icon-button>
                            <div class="title">[[item.headline]]</div>
                        </paper-toolbar>
                        <paper-card elevation="0" animated-shadow="false">
                            <div class="card-content" style="padding: 16px">
                                <!-- <div inner-h-t-m-l="[[item.body]]"></div> -->
                                <template is="juicy-html" content$="[[item.body]]"></template>
                            </div>
                        </paper-card>
                    </div>
                </template>
            </template>
        </iron-swipeable-pages>

    </template>
    <script>
        Polymer({
            is: 'list-detail',
            properties: {
                items: {
                    type: Array,
                    value: []
                },
                selected: {
                    type: Number,
                    value: 0,
                    notify: true
                }
            },
            _showPhoto: function(item) {
                return item.kind == 'photo';
            },
            _showList: function(e) {
                // this.selected = e.model.index;
                this.fire('show-grid');
            },
            _showExif: function(e) {
                var id = e.model.item.slug,
                    dialog = document.getElementById(id);
                if (dialog) {
                    dialog.open();
                }
            }
        });
    </script>
</dom-module>
