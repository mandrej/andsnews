<link rel="import" href="elements.html">
<link rel="import" href="list-grid.html">
<link rel="import" href="list-detail.html">

<dom-module id="index-page">
	<template>
		<app-location route="{{route}}" use-hash-as-path></app-location>

		<!-- /(photo|entry|search) -->
		<app-route
			route="{{route}}"
			pattern="/:kind"
			data="{{data}}"
			tail="{{tail}}"
			active="{{active}}"></app-route>

		<app-route
			route="{{tail}}"
			pattern="/:field"
			data="{{dataField}}"
			tail="{{tailField}}"
			active="{{activeField}}"></app-route>

		<app-route
			route="{{tailField}}"
			pattern="/:value"
			data="{{dataValue}}"
			tail="{{tailValue}}"
			active="{{activeValue}}"></app-route>

		<iron-pages selected="grid" attr-for-selected="data-view" id="switch">
			<list-grid
				data-view="grid"
				kind="{{data.kind}}"
				field="{{dataField.field}}"
	            value="{{dataValue.value}}"
				route="{{route}}"
				selected="{{selected}}"
				loading="{{loading}}"
				items="{{items}}"></list-grid>

			<list-detail
				data-view="detail"
				route="{{route}}"
				selected="[[selected]]"
				items="[[items]]"></list-detail>
		</iron-pages>

	</template>

	<script>
		Polymer({
			is: 'index-page',
			attached: function() {
				if (!this.route.path) {
					this.set('route.path', '/photo');
					this.set('data.kind', 'photo');
					this.set('dataField.field', null);
					this.set('dataValue.value', null);
				}
			},
			properties: {
				items: {
					type: Array,
					value: [],
					notify: true
				},
				toggleView: {
					type: Boolean,
					value: false,
					notify: true
				}
			},
			listeners: {
				'show-detail': '_toggleView',
				'show-grid': '_toggleView'
			},
			_toggleView: function(e) {
				this.toggleView = !this.toggleView;
				if (this.toggleView) {
					this.$.switch.selected = 'detail';
				} else {
					this.$.switch.selected = 'grid';
				}
			},
		});
	</script>
</dom-module>
